import subprocess

def adicionar_excecao_pasta(pasta):
    cmd = f'powershell -ExecutionPolicy Bypass -Command "Add-MpPreference -ExclusionPath \\"{pasta}\\""'
    result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
    if result.returncode != 0:
        print(f"Erro ao adicionar exceção pasta: {result.stderr}")

def adicionar_excecao_arquivo(arquivo):
    cmd = f'powershell -ExecutionPolicy Bypass -Command "Add-MpPreference -ExclusionProcess \\"{arquivo}\\""'
    result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
    if result.returncode != 0:
        print(f"Erro ao adicionar exceção arquivo: {result.stderr}")

if __name__ == "__main__":
    pasta = r"D:\\" ## Pasta Adicionada a exclusão do anti virus
    arquivo = r"D:\\" ##Arquivo que sera colocado na exclusao do defender

    adicionar_excecao_pasta(pasta)
    adicionar_excecao_arquivo(arquivo)
